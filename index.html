<!DOCTYPE html>
<html>
<head>
  <title>NYC Housing Crisis Map</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- MarkerCluster -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />

  <!-- Geocoder (Search bar) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css">

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <!-- Marker Cluster -->
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

  <!-- Heatmap -->
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

  <!-- Search bar -->
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
</head>

<body>

  <!-- UI buttons -->
  <div id="controls">
    <button id="toggleHeat">Toggle Heatmap</button>
    <button id="toggleCluster">Toggle Clusters</button>

    <div class="filter-section">
      <b>Boroughs:</b><br>
      <button class="borough-btn" data-boro="MN">Manhattan</button>
      <button class="borough-btn" data-boro="BK">Brooklyn</button>
      <button class="borough-btn" data-boro="BX">Bronx</button>
      <button class="borough-btn" data-boro="QN">Queens</button>
      <button class="borough-btn" data-boro="SI">Staten Island</button>
      <button id="showAll">Show All</button>
    </div>
  </div>

  <!-- Stats panel -->
  <div id="statsPanel">
    <h3>NYC Housing Crisis Summary</h3>
    <p>Total Permits Loaded: <span id="totalPermits">0</span></p>
    <div id="byBorough"><b>By Borough:</b>
      <ul id="boroughList"></ul>
    </div>
    <div id="byPermitType"><b>By Permit Type:</b>
      <ul id="permitTypeList"></ul>
    </div>
    <div id="byJobType"><b>By Job Type:</b>
      <ul id="jobTypeList"></ul>
    </div>
  </div>

  <!-- District-specific panel -->
  <div id="districtPanel" style="position: absolute; right: 20px; bottom: 20px; width: 300px; background: white; padding: 12px; border-radius:8px; box-shadow: 0 0 10px rgba(0,0,0,0.2); z-index:1000; display:none;">
    <h4 id="districtTitle">District Summary</h4>
    <p>Permits in district: <span id="districtTotal">0</span></p>
    <p>NB (New Building): <span id="districtNB">0</span></p>
    <p>A1 (Major Alterations): <span id="districtA1">0</span></p>
    <p>Development Score: <span id="districtScore">0</span></p>
    <div id="districtBreakdowns">
      <b>By Permit Type:</b>
      <ul id="districtPermitTypeList"></ul>
      <b>By Job Type:</b>
      <ul id="districtJobTypeList"></ul>
    </div>
    <button id="showDistrictOnly">Show Only This District</button>
    <button id="showAllDistricts">Show All Districts</button>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <!-- Legend -->
  <div id="legend">
    <div><b>Permit Type (marker colors)</b></div>
    <div class="legend-item"><span class="legend-dot permit-PL"></span>PL – Plumbing</div>
    <div class="legend-item"><span class="legend-dot permit-EW"></span>EW – Electrical / Excavation</div>
    <div class="legend-item"><span class="legend-dot permit-NB"></span>NB – New Building (permit)</div>
    <div class="legend-item"><span class="legend-dot permit-AL"></span>AL – Alteration (permit)</div>
    <div class="legend-item"><span class="legend-dot permit-FO"></span>FO – Foundation</div>
    <div class="legend-item"><span class="legend-dot permit-EQ"></span>EQ – Equipment</div>
    <div class="legend-item"><span class="legend-dot permit-DM"></span style="border:1px solid #999;">DM – Demolition</div>
    <div class="legend-item"><span class="legend-dot permit-SG"></span>SG – Sign</div>
    <div class="legend-item"><span class="legend-dot permit-OTHER"></span>Other
    </div>

    <hr style="margin:8px 0;">
    <div><b>Job Types (in popups / sidebar)</b></div>
    <div class="legend-item">A1 – Major Alteration</div>
    <div class="legend-item">A2 – Moderate Alteration</div>
    <div class="legend-item">A3 – Minor Alteration</div>
    <div class="legend-item">NB – New Building</div>
    <div class="legend-item">DM – Demolition</div>
    <div class="legend-item">SG – Sign</div>
  </div>

  <script type="module" src="script.js"></script>

</body>
</html>
